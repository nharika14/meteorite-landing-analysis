---
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE,
                      fig.width = 7, fig.height = 4.5)
```

# Analysis on Meteorite Landings Since 1900
#### Harika Nalika, Ethan Olderog

## Introduction

The goal of this project is to look at NASA’s **Meteorite Landings** data and understand simple patterns that anyone can see. Meteorites are rocks from space that people either **find** on the ground or **see** fall from the sky. By looking at these records, we want to know when counts went up, how typical sizes changed, what types show up the most, and where the biggest pieces are usually found.

In pursuit of the stated goal, we will explore the following questions:

1. When are meteorites most likely to be recorded? Are there long term trends over the years?  
2. How has the typical size changed across decades?  
3. What types are most common over time? Does the mix change?  
4. Where are the heaviest pieces recorded? Do location and environment matter?  

These are the main questions we are looking to answer in this project. With the findings we hope to find the patterns in meteorite landing locations and the properties over the years.


## Data

### Structure

The link to the dataset is https://data.nasa.gov/dataset/meteorite-landings. We use NASA’s *Meteorite Landings* CSV (This comprehensive data set from The Meteoritical Society contains information on all of the known meteorite landings.The variables are `name`, `id`, `nametype`, `recclass`, `mass`, `fall`, `year`, `reclat`, `reclong`, `GeoLocation`). Each row is one meteorite. The file lists the **class** (for example L6 or H5), **mass** in grams, whether it was **Found** or **Fell** (witnessed fall), and the **location**.

We focus on **1900 to present** to keep reporting more consistent and to avoid very old records with missing details.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(scales)
library(knitr)

# Optional for map; code falls back if not installed
has_maps <- requireNamespace("maps", quietly = TRUE)
```

### Cleaning

We turn dates into plain years, change mass and coordinates to numbers, drop impossible or missing values, and keep observations from **1900** through the current year with valid coordinates. We also created **decade** bins so that long term changes are easier to see.

```{r}
# Read
stopifnot(file.exists("meteorite-landings.csv"))
raw_mets <- readr::read_csv("meteorite-landings.csv", guess_max = 100000, show_col_types = FALSE)

# Standardize mass column if needed
if (!("mass" %in% names(raw_mets)) && ("mass (g)" %in% names(raw_mets))) {
  raw_mets <- dplyr::rename(raw_mets, mass = `mass (g)`)
}

# Extract lat/long from GeoLocation when separate columns are missing
if (!("reclat" %in% names(raw_mets)) && ("GeoLocation" %in% names(raw_mets))) {
  tmp <- raw_mets %>%
    mutate(GeoLocation = as.character(GeoLocation)) %>%
    mutate(GeoLocation_clean = gsub("[()]", "", GeoLocation)) %>%
    tidyr::separate(GeoLocation_clean, into = c("lat_extracted","long_extracted"),
                    sep = ",", fill = "right", extra = "drop", remove = FALSE) %>%
    mutate(reclat = trimws(lat_extracted),
           reclong = trimws(long_extracted)) %>%
    select(-lat_extracted, -long_extracted, -GeoLocation_clean)
  raw_mets <- tmp
}

to_num <- function(x) { if (is.numeric(x)) x else suppressWarnings(as.numeric(as.character(x))) }
this_year <- lubridate::year(Sys.Date())

# Year parsing: try ymd_hms, then ymd, then integer fallback
parse_year <- function(x) {
  y <- suppressWarnings(lubridate::year(lubridate::ymd_hms(as.character(x))))
  y[is.na(y)] <- suppressWarnings(lubridate::year(lubridate::ymd(as.character(x[is.na(y)]))))
  xi <- suppressWarnings(as.integer(as.character(x)))
  y[is.na(y)] <- xi[is.na(y)]
  y
}

mets <- raw_mets %>%
  mutate(
    year = parse_year(year),
    mass = to_num(mass),
    lat  = to_num(reclat),
    long = to_num(reclong)
  ) %>%
  filter(!is.na(year), year >= 1900, year <= this_year,
         !is.na(mass), mass > 0,
         !is.na(lat), !is.na(long)) %>%
  mutate(decade = floor(year/10)*10)

glimpse(mets)
```

### Why these cleaning choices

We keep the time window from 1900 to today so that reporting practices are more comparable. Very old records often miss mass or coordinates and that makes maps and size comparisons hard to trust. We require a positive mass because zero or negative values are clearly entry mistakes because mass cannot be negative. We also filterred out the meteorites with no coordinates out so we can have a clear understanding of where the meteorites are more prone to fall in the world and why. Finally, we use the year from a timestamp if it exists, fall back to a date, and then to a plain number. This order avoids losing valid years that are stored in different ways across files.

### Key variables after cleaning

```{r}
var_types <- tibble(
  variable = c("name","year","mass","recclass","fall","lat","long","decade"),
  type = c(class(mets$name)[1],
           class(mets$year)[1],
           class(mets$mass)[1],
           class(mets$recclass)[1],
           class(mets$fall)[1],
           class(mets$lat)[1],
           class(mets$long)[1],
           class(mets$decade)[1]),
  example = c(as.character(mets$name[which(!is.na(mets$name))[1]]),
              mets$year[1],
              mets$mass[1],
              as.character(mets$recclass[which(!is.na(mets$recclass))[1]]),
              as.character(mets$fall[which(!is.na(mets$fall))[1]]),
              mets$lat[1],
              mets$long[1],
              mets$decade[1])
)

knitr::kable(var_types, caption = "Variable types and a sample value after cleaning")
```

### Summary of the dataset after cleaning

```{r}
summary_tbl <- mets %>%
  summarise(
    records = n(),
    classes = n_distinct(recclass),
    share_witnessed = mean(tolower(fall) == "fell", na.rm = TRUE),
    share_antarctica = mean(lat <= -60, na.rm = TRUE),
    mass_min_g = min(mass, na.rm = TRUE),
    mass_q1_g  = quantile(mass, 0.25, na.rm = TRUE),
    mass_median_g = median(mass, na.rm = TRUE),
    mass_mean_g = mean(mass, na.rm = TRUE),
    mass_q3_g  = quantile(mass, 0.75, na.rm = TRUE),
    mass_max_g = max(mass, na.rm = TRUE)
  ) %>%
  mutate(
    share_witnessed = percent(share_witnessed),
    share_antarctica = percent(share_antarctica)
  )

knitr::kable(summary_tbl, caption = "Summary of the dataset after cleaning")
```

**How to read this table.** There are **`r format(summary_tbl$records, big.mark=",")`** records in the cleaned data spread across **`r summary_tbl$classes`** distinct classes. Only **`r summary_tbl$share_witnessed`** are witnessed falls, so most entries are finds that were collected later. About **`r summary_tbl$share_antarctica`** come from Antarctic latitudes, which shows how important that region is for recovery.

For mass, the smallest recorded piece is **`r format(round(summary_tbl$mass_min_g,1), big.mark=",")` g**. A quarter of all pieces are below **`r format(round(summary_tbl$mass_q1_g,1), big.mark=",")` g**. The median is **`r format(round(summary_tbl$mass_median_g,1), big.mark=",")` g**, which means half the records are lighter than that and half are heavier. The mean is **`r format(round(summary_tbl$mass_mean_g,1), big.mark=",")` g**, which is usually higher than the median because a few very heavy meteorites pull the average up. Three quarters of the pieces are below **`r format(round(summary_tbl$mass_q3_g,1), big.mark=",")` g**. The largest piece reaches **`r format(round(summary_tbl$mass_max_g,1), big.mark=",")` g**. The big gap between the upper quartile and the maximum and the difference between mean and median tell us the mass distribution is skewed to the right(has a long right tail). That is a helpful warning when we look at size trends later.

## Variables

- **name**: The name assigned to the meteorite.
- **id**: A unique identifier for each meteorite in the dataset.
- **nametype**: Indicates whether the name is “Valid” or “Relict.”
- **recclass**: The classification of the meteorite (e.g., L6, H5), based on composition and structure.
- **mass**: The mass of the meteorite in grams.
- **fall**: Whether the meteorite was “Found” or “Fell” (witnessed at the time of landing).
- **year**: The year in which the meteorite landed or was found (parsed from various formats).
- **reclat**: Latitude coordinate where the meteorite was recovered.
- **reclong**: Longitude coordinate where the meteorite was recovered.
- **GeoLocation**: A string version of the latitude and longitude combined, typically in `(lat, long)` format.


## Results

We tried to find answers to our questions in this section. Our main focus was to find any noticeable patterns with the locations and the types of the findings. If the patterns or the size have changed over the years. If the size has a role to play in where they might fall/found.

### When are meteorites most likely to be recorded? Are there long term trends over the years?

```{r}
yr_counts <- mets %>% count(year, name = "n")
peak <- yr_counts %>% slice_max(n, with_ties = FALSE)

ggplot(yr_counts, aes(year, n)) +
  geom_line() +
  labs(title = "Meteorites Recorded per Year",
       x = "Year", y = "Count")
```

The line starts low in the early 1900s and climbs after the 1960s. It reaches a high point in **`r peak$year`** with **`r peak$n`** records. The main idea here is simple. When people look more, they find more. Field searches, museum uploads, and better reporting all push the line up. If the sky itself were sending more rocks, we would also see a clear rise in witnessed falls but we do not see that. This could mean that the increase comes from effort and record keeping not a sudden surge in meteorites landings.

Overall, this pattern reflects human effort more than cosmic change. It's important to recognize that catalog completeness, institutional priorities, and funding cycles all shape what gets recorded.So, some spikes or dips may reflect recording artifacts more than physical reality.

#### Sensitivity: Antarctica

```{r}
mets_no_ant <- mets %>% filter(lat > -60)
yr_all  <- mets %>% count(year, name = "n_all")
yr_noA  <- mets_no_ant %>% count(year, name = "n_no_ant")
yr_comp <- dplyr::full_join(yr_all, yr_noA, by = "year") %>%
  tidyr::pivot_longer(-year, names_to = "set", values_to = "n")

ggplot(yr_comp, aes(year, n, linetype = set)) +
  geom_line() +
  labs(title = "Annual Counts With and Without Antarctica",
       x = "Year", y = "Count", linetype = "")
```

Antarctica is famous for meteorite hunting because dark rocks are easy to spot on ice and they're preseved well in the cold and dry conditions. When we remove Antarctica the total counts drop significantly but the overall trend still is up. That tells us two things. First, Good hunting grounds make a difference, and the world as a whole has put more time into searching and logging finds.This graph is a reminder that all the findings that we have in record are not the only findings.

#### Witnessed falls only

```{r}
fell_only <- mets %>% filter(tolower(fall) == "fell") %>% count(year, name = "n")
ggplot(fell_only, aes(year, n)) +
  geom_line() +
  labs(title = "Witnessed Falls per Year",
       x = "Year", y = "Count")
```
This line is much lower than the total meteorite count because only a small fraction of entries are witnessed falls.Most records come from meteorites that were found later, not seen falling. While this line does vary over time, it lacks the dramatic increase seen in the full dataset. That contrast supports the idea that the surge in total counts is due to increased search and reporting efforts. Not more meteorites actually falling from space.
---

### How has the typical size changed?

```{r}
dec_med <- mets %>% group_by(decade) %>%
  summarise(median_mass = median(mass, na.rm = TRUE), .groups = "drop")

early  <- dec_med %>% slice_min(decade, n = 1)
recent <- dec_med %>% slice_max(decade, n = 1)

ggplot(dec_med, aes(decade, median_mass)) +
  geom_line() +
  labs(title = "Median Mass by Decade",
       x = "Decade", y = "Median Mass (g)")
```

The typical size is larger in early decades and smaller in recent decades. For example, the early point is around `r format(round(early$median_mass,1), big.mark=",")` grams in `r early$decade`, while the most recent point is around `r format(round(recent$median_mass,1), big.mark=",")` grams in `r recent$decade`. This fits a common sense story. As searches improved, people started finding lots of small pieces that used to be missed. We use the median on purpose. A few giant meteorites would pull the average up, but the median shows what a middle sized find looks like. The main takeaway is that the catalog has filled in the small end over time.

#### Robustness: exclude irons

```{r}
dec_med_no_iron <- mets %>%
  filter(!grepl("Iron", recclass, ignore.case = TRUE)) %>%
  group_by(decade) %>%
  summarise(median_mass = median(mass, na.rm = TRUE), .groups = "drop")

ggplot(dec_med_no_iron, aes(decade, median_mass)) +
  geom_line() +
  labs(title = "Median Mass by Decade (Excluding Irons)",
       x = "Decade", y = "Median Mass (g)")
```

Iron meteorites are tough and easy to notice, so they could make earlier decades look heavier. When we remove irons, the downward trend still holds. That means the smaller typical size in later decades comes from finding more small stones, not only from a few famous heavy irons.

---

### What types are most common over time?

```{r}
class_counts <- mets %>%
  filter(!is.na(recclass), recclass != "") %>%
  count(recclass, sort = TRUE)

top_classes <- class_counts %>% slice_head(n = 10) %>%
  mutate(share = n / sum(n))

knitr::kable(top_classes, caption = "Top 10 meteorite classes in the cleaned data",
             col.names = c("Class","Count","Share"))

class_by_decade <- mets %>%
  filter(recclass %in% top_classes$recclass) %>%
  group_by(recclass, decade) %>%
  summarise(n = n(), .groups = "drop")

oc_share <- mean(grepl("^(H|L|LL)", mets$recclass), na.rm = TRUE)

ggplot(class_by_decade, aes(decade, n, color = recclass)) +
  geom_line() +
  labs(title = "Top Classes Across Decades",
       x = "Decade", y = "Count", color = "Class")
```
This plot shows how the 10 most common meteorite classes have changed over time. You can see that most of them really start climbing in the 1970s to 2000s, which lines up with the overall increase in meteorite finds. Classes like L6, H5, and H6 show up the most and stay that way across the decades.

Chondrites (the L and H types) are super common and easier to spot and identify. Using color helps us quickly compare their trends. For example, L6 peaks pretty sharply around the 1980s. Rarer ones like CM2 are still there, just in much smaller amounts. So the main idea here is that we’re mostly adding more of the same kinds of meteorites to the catalog, not finding totally new ones.
---

### Meteorite finds by hemisphere
```{r}
mets %>%
  filter(!is.na(lat)) %>%
  mutate(hemisphere = ifelse(lat >= 0, "Northern", "Southern")) %>%
  count(hemisphere) %>%
  ggplot(aes(x = hemisphere, y = n, fill = hemisphere)) +
  geom_col(show.legend = FALSE) +
  labs(title = "Meteorite Finds by Hemisphere",
       x = "Hemisphere", y = "Number of Finds")

```
This bar plot compares the number of meteorite findings in the Northern vs. Southern Hemisphere. The Southern Hemisphere has more recorded finds. That’s largely because of Antarctica, and USA and Africa contribute for the north hemisphere. This graph highlights how environmental conditions and search efforts influence the data we have.

---
### Distribution of meteorite masses(Log Scale)
```{r}
mets %>%
  filter(!is.na(mass), mass > 0) %>%
  ggplot(aes(x = mass)) +
  geom_histogram(bins = 70, fill = "grey", alpha = 10) +
  scale_x_log10(labels = scales::comma) +
  labs(title = "Distribution of Meteorite Masses (Log Scale)",
       x = "Mass (g, log scale)", y = "Count")

```
This histogram shows how meteorite masses are distributed, using a logarithmic scale on the x-axis. Most meteorites are pretty small and really big ones are rare. The log scale helps show this skewed distribution, where a handful of heavy meteorites make up a huge portion of the total mass. This is why we often focus on the median mass instead of the mean. The mean would be pulled way up by a few huge outliers.

### Where are the heaviest pieces recorded?

```{r}
mass_cutoff <- stats::quantile(mets$mass, 0.99, na.rm = TRUE)
top1 <- mets %>% filter(mass >= mass_cutoff, !is.na(lat), !is.na(long))

top15 <- mets %>% slice_max(mass, n = 15)
top15_iron <- sum(grepl("Iron", top15$recclass, ignore.case = TRUE), na.rm = TRUE)

if (has_maps) {
  world <- ggplot2::map_data("world")
  ggplot() +
    geom_polygon(data = world, aes(long, lat, group = group),
                 fill = "gray90", color = "white", linewidth = 0.2) +
    geom_point(data = top1, aes(long, lat), size = 1.5, alpha = 0.6) +
    coord_fixed(1.3) +
    labs(title = "Heaviest 1% of Meteorites: Locations",
         x = "Longitude", y = "Latitude")
} else {
  ggplot(top1, aes(long, lat)) +
    geom_point(size = 1.5, alpha = 0.6) +
    coord_fixed(1.3) +
    labs(title = "Heaviest 1% of Meteorites: Locations (No Basemap)",
         x = "Longitude", y = "Latitude")
}
```

The heaviest pieces tend to show up in open and dry places such as deserts and ice fields. These landscapes make dark rocks easier to see and they protect them from weather. In the list of the very largest fifteen, **`r top15_iron`** are irons. That matches what people find in the field because iron holds together well and stands out. The map is a picture of where finds were made, not a count of where most rocks fell. In short, location and environment matter a lot for what ends up in the catalog.
---

### All of the findings over the world
```{r}
# Filter out rows with missing coordinates
mets_with_coords <- mets %>% filter(!is.na(lat), !is.na(long))

# Base map data
world <- map_data("world")

# Plot with better visibility and clarity
ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group = group),
               fill = "gray95", color = "white", linewidth = 0.2) +
  geom_point(data = mets_with_coords,
             aes(x = long, y = lat),
             color = "black", size = 1.2, alpha = 0.5) +
  coord_fixed(1.3) +
  labs(
    title = "All Meteorite Finds: Global Distribution",
    x = "Longitude",
    y = "Latitude"
  ) +
  theme_minimal()
```
This map shows where all recorded meteorite finds have been made around the world. We can clearly see dense clusters in North Africa, the United States, and especially Antarctica. That’s not because more meteorites fall in those spots. Instead, it reflects where people are able to find them. Antarctica stands out because dark rocks are super easy to spot against the ice, and the cold preserves them really well. Deserts help too, like in the Sahara and parts of Australia. On the other hand, we see fewer finds in jungles, cities, and oceans where meteorites can get buried, lost, or just ignored.

## Conclusion
Our extensive research on global meteorite findings found trends that challenged some of our assumptions and provided fresh insights into how these space pebbles are discovered and recorded. We in the beginning assumed that meteorite data would reflect where and when they fell. Instead, we found that technology, and environment shape the records significantly more than we thought. Meteorites are discovered not only where they land, but also where people look for them and, more importantly, where they are easiest to notice and survive. This is why deserts and Antarctica appear so clearly on our maps. The increase of reported meteorites over the last few decades, particularly since the 1960s, is due to improved field trips, digital record keeping, and cataloging rather than more meteorites falling. We also discovered that the median mass of meteorites has continuously decreased over decades. This isn't because meteorites are getting smaller.We just got better at finding the smaller ones which would go unnoticed before. Many of the largest are made of iron, which is visually striking and weather resistant.